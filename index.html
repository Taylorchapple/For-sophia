<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Valentine's Invitational</title>
    
    <script src="https://unpkg.com/alpinejs" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,700&family=Montserrat:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">

    <style>
        :root { 
            --fairway: #2d5a27; --green: #3d8c40; --sand: #e3c18a; 
            --rose: #ff4d6d; --ivory: #f8f5f2; --dark: #1a1a1a;
        }

        body { margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; background-color: #1a050d; overflow: hidden; }
        
        /* GOLF STYLES */
        #golf-section { position: fixed; inset: 0; z-index: 20; background: var(--fairway); }
        #ui { position: absolute; top: 30px; width: 100%; text-align: center; color: var(--dark); pointer-events: none; z-index: 30; }
        h1.golf-title { font-family: 'Playfair Display', serif; font-size: 2.8rem; margin: 0; font-style: italic; }
        .stats { margin-top: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 2px; color: var(--rose); }
        canvas { display: block; cursor: crosshair; }

        #victory-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.96);
            display: none; flex-direction: column; align-items: center;
            justify-content: center; z-index: 50; text-align: center;
            animation: fadeIn 0.8s forwards;
        }
        .victory-text { font-family: 'Playfair Display', serif; font-size: 4rem; color: var(--rose); }

        .next-btn {
            background: var(--dark); color: white; padding: 15px 40px; border-radius: 50px;
            font-weight: 600; text-transform: uppercase; letter-spacing: 2px; cursor: pointer;
            transition: 0.3s; margin-top: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .next-btn:hover { transform: translateY(-3px); background: var(--rose); }

        /* ROMANTIC SECTION STYLES */
        #romantic-section { position: fixed; inset: 0; z-index: 10; display: none; }
        .romantic { font-family: 'Great Vibes', cursive; }
        .bg-overlay { position: fixed; inset: 0; background: radial-gradient(circle at center, #4d0220 0%, #1a050d 100%); z-index: -1; }
        .petal { position: fixed; background: #ff85a2; border-radius: 150% 0 150% 0; opacity: 0.6; pointer-events: none; animation: fall linear infinite; z-index: 5; }
        @keyframes fall { 0% { transform: translateY(-10vh) rotate(0deg); opacity: 0; } 10% { opacity: 0.7; } 100% { transform: translateY(110vh) rotate(360deg); opacity: 0; } }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 2.5rem; }
        .btn-pink { background: linear-gradient(45deg, #db2777, #f472b6); transition: all 0.3s ease; }
        .fade-in { animation: fadeIn 1.5s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* CURTAIN */
        #curtain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; transform: translateY(100%);
            transition: transform 1.2s cubic-bezier(0.7, 0, 0.3, 1); z-index: 100;
        }
    </style>
</head>
<body x-data="romanticApp()">

    <div id="curtain"></div>

    <div id="golf-section">
        <div id="ui">
            <h1 class="golf-title">The Valentine's Invitational</h1>
            <div class="stats" id="stroke-count">Stroke: 1</div>
            <p style="font-size: 0.9rem; opacity: 0.7;">Drag back to aim for my heart.</p>
        </div>

        <div id="victory-overlay">
            <div class="victory-text">Well done Phiwi! ‚ù§Ô∏è</div>
            <div class="victory-subtext">"Get her some P790s!"</div>
            <p style="font-style: italic; color: #666; max-width: 400px; margin-top: 10px;">A championship performance. You've officially conquered the course.</p>
            <button class="next-btn" onclick="proceedToRomantic()">See what's next</button>
        </div>
        <canvas id="golfCanvas"></canvas>
    </div>

    <div id="romantic-section" :style="gameEnded ? 'display: block' : 'display: none'">
        <div class="bg-overlay"></div>
        
        <template x-for="n in 20">
            <div class="petal" :style="`left: ${Math.random() * 100}%; width: 15px; height: 15px; animation-duration: ${Math.random() * 5 + 5}s; animation-delay: ${Math.random() * 5}s;` "></div>
        </template>

        <div class="relative z-10 min-h-screen flex items-center justify-center p-6 text-center text-white">
            
            <template x-if="page === 'intro'">
                <div class="fade-in space-y-8">
                    <h1 class="romantic text-7xl text-pink-200">Sophia</h1>
                    <p class="tracking-[0.4em] text-[10px] uppercase text-pink-400">A journey made just for you</p>
                    <button @click="page = 'quiz'" class="btn-pink px-12 py-4 rounded-full font-semibold uppercase tracking-widest text-xs">Begin the Journey</button>
                </div>
            </template>

            <template x-if="page === 'quiz'">
                <div class="glass w-full max-w-md p-10 fade-in">
                    <p class="text-[10px] uppercase tracking-widest text-pink-500 mb-4">Memory <span x-text="currentIdx + 1"></span> of 5</p>
                    <h2 class="text-xl font-light leading-relaxed mb-8" x-text="questions[currentIdx].text"></h2>
                    <div class="space-y-4">
                        <template x-for="(opt, i) in questions[currentIdx].options" :key="i">
                            <button @click="answer(i)" class="w-full py-4 px-6 rounded-2xl bg-white/5 border border-white/10 hover:border-pink-500 transition-all text-sm font-light">
                                <span x-text="opt"></span>
                            </button>
                        </template>
                    </div>
                </div>
            </template>

            <template x-if="page === 'vault'">
                <div class="glass w-full max-w-md p-10 fade-in space-y-6">
                    <h2 class="romantic text-5xl text-pink-200">The Love Vault</h2>
                    <p class="text-[10px] uppercase tracking-widest text-white/40 italic">You have <span x-text="hearts" class="text-pink-400 font-bold"></span> Hearts</p>
                    <div class="space-y-4">
                        <template x-for="(note, i) in notes" :key="i">
                            <div class="p-5 rounded-2xl bg-black/30 border border-white/5 text-left">
                                <div x-show="!note.unlocked" class="flex justify-between items-center">
                                    <span class="text-xs uppercase tracking-widest font-bold" x-text="note.title"></span>
                                    <button @click="unlock(i)" :disabled="hearts < note.cost" class="px-4 py-2 rounded-lg text-[10px] font-bold uppercase" :class="hearts >= note.cost ? 'bg-pink-600' : 'bg-white/10 text-white/20'">Unlock (<span x-text="note.cost"></span> ‚ù§Ô∏è)</button>
                                </div>
                                <p x-show="note.unlocked" class="text-sm font-light italic leading-relaxed text-pink-100" x-text="note.content"></p>
                            </div>
                        </template>
                    </div>
                    <button x-show="notes.every(n => n.unlocked)" @click="page = 'pre-proposal'" class="w-full py-5 btn-pink rounded-full font-bold uppercase text-xs tracking-widest mt-4">Continue</button>
                </div>
            </template>

            <template x-if="page === 'pre-proposal'">
                <div class="fade-in space-y-12">
                    <h2 class="romantic text-7xl text-pink-200">Sophia...</h2>
                    <p class="text-lg font-extralight tracking-[0.3em] uppercase max-w-xs mx-auto leading-loose">Since it is February, and you are my beautiful precious girlfriend...</p>
                    <button @click="page = 'proposal'" class="px-12 py-4 border border-pink-400 text-pink-400 rounded-full font-bold text-xs tracking-[0.3em] hover:bg-pink-400 hover:text-white transition-all">I HAVE A QUESTION...</button>
                </div>
            </template>

            <template x-if="page === 'proposal'">
                <div class="glass w-full max-w-lg p-16 fade-in space-y-12 border-pink-500/40">
                    <h2 class="text-2xl font-light leading-relaxed">To my beautiful Sophia,<br><span class="romantic text-6xl text-pink-300 block mt-8">Will you be my Valentine?</span></h2>
                    <div class="flex flex-col space-y-4">
                        <button @click="page = 'final'" class="w-full py-6 btn-pink rounded-full font-bold text-xl tracking-widest">YES!</button>
                    </div>
                </div>
            </template>

            <template x-if="page === 'final'">
                <div class="fade-in space-y-6">
                    <div class="text-9xl mb-8 animate-bounce">üçï</div>
                    <h2 class="romantic text-7xl text-pink-200">Correct choice!</h2>
                    <p class="text-lg font-light tracking-widest uppercase text-pink-100">Ok, let's get Pizza Express now.</p>
                    <div class="mt-20 space-opacity-30">
                        <p class="text-[10px] tracking-[1em] uppercase">I love you forever</p>
                        <p class="romantic text-3xl">Taylor</p>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <script>
        // --- GOLF GAME ENGINE ---
        const canvas = document.getElementById('golfCanvas');
        const ctx = canvas.getContext('2d');
        const curtain = document.getElementById('curtain');
        const overlay = document.getElementById('victory-overlay');
        const golfSection = document.getElementById('golf-section');

        let width, height, ball, hole, bunker, green;
        let mouse = { x: 0, y: 0, isDown: false };
        let strokes = 1;
        let gameActive = true;

        function initGolf() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            ball = { x: width * 0.15, y: height / 2, r: 9, vx: 0, vy: 0, moving: false };
            hole = { x: width * 0.85, y: height / 2, r: 22 };
            green = { x: width * 0.7, y: height / 2 - 180, w: width * 0.25, h: 360 };
            bunker = { x: width * 0.45, y: height / 2 - 100, w: 140, h: 200 };
        }

        window.addEventListener('mousedown', (e) => { if (gameActive && !ball.moving) { mouse.isDown = true; mouse.x = e.clientX; mouse.y = e.clientY; } });
        window.addEventListener('mousemove', (e) => { if (mouse.isDown) { mouse.x = e.clientX; mouse.y = e.clientY; } });
        window.addEventListener('mouseup', (e) => {
            if (mouse.isDown) {
                let dx = ball.x - e.clientX; let dy = ball.y - e.clientY;
                ball.vx = dx * 0.12; ball.vy = dy * 0.12;
                ball.moving = true; mouse.isDown = false;
                if(ball.vx !== 0 || ball.vy !== 0) document.getElementById('stroke-count').innerText = `Stroke: ${strokes++}`;
            }
        });

        function drawHeart(x, y, size) {
            ctx.save(); ctx.translate(x, y); ctx.beginPath(); ctx.moveTo(0, 0);
            ctx.bezierCurveTo(0, -size/2, -size, -size/2, -size, 0);
            ctx.bezierCurveTo(-size, size/1.5, 0, size, 0, size * 1.3);
            ctx.bezierCurveTo(0, size, size, size/1.5, size, 0);
            ctx.bezierCurveTo(size, -size/2, 0, -size/2, 0, 0);
            ctx.fillStyle = '#1a1a1a'; ctx.fill(); ctx.restore();
        }

        function updateGolf() {
            if (ball.moving) {
                let friction = 0.98;
                if (ball.x > bunker.x && ball.x < bunker.x + bunker.w && ball.y > bunker.y && ball.y < bunker.y + bunker.h) friction = 0.88;
                else if (ball.x > green.x) friction = 0.992;
                ball.x += ball.vx; ball.y += ball.vy;
                ball.vx *= friction; ball.vy *= friction;
                if (ball.y < 0 || ball.y > height) ball.vy *= -0.6;
                if (ball.x < 0 || ball.x > width) ball.vx *= -0.6;
                if (Math.abs(ball.vx) < 0.15 && Math.abs(ball.vy) < 0.15) { ball.vx = 0; ball.vy = 0; ball.moving = false; }
                let dist = Math.hypot(ball.x - hole.x, ball.y - (hole.y + 10));
                if (dist < hole.r && Math.abs(ball.vx) < 3.5) winGolf();
            }
        }

        function drawGolf() {
            ctx.fillStyle = '#2d5a27'; ctx.fillRect(0, 0, width, height);
            ctx.fillStyle = '#3d8c40'; ctx.beginPath();
            ctx.ellipse(green.x + green.w/2, green.y + green.h/2, green.w/1.2, green.h/1.2, 0, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = '#e3c18a'; ctx.beginPath();
            ctx.ellipse(bunker.x + bunker.w/2, bunker.y + bunker.h/2, bunker.w/2, bunker.h/2, 0, 0, Math.PI*2); ctx.fill();
            drawHeart(hole.x, hole.y, 20);
            if (mouse.isDown) {
                ctx.beginPath(); ctx.moveTo(ball.x, ball.y);
                ctx.lineTo(ball.x + (ball.x - mouse.x), ball.y + (ball.y - mouse.y));
                ctx.strokeStyle = 'rgba(255,255,255,0.4)'; ctx.setLineDash([5, 5]); ctx.stroke(); ctx.setLineDash([]);
            }
            ctx.beginPath(); ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
            ctx.fillStyle = 'white'; ctx.fill();
            updateGolf(); requestAnimationFrame(drawGolf);
        }

        function winGolf() {
            gameActive = false; ball.vx = 0; ball.vy = 0; ball.moving = false;
            setTimeout(() => {
                overlay.style.display = 'flex';
                confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 }, colors: ['#ff4d6d', '#ffffff', '#ffd700'] });
            }, 300);
        }

        // --- TRANSITION LOGIC ---
        function proceedToRomantic() {
            curtain.style.transform = "translateY(0)";
            setTimeout(() => {
                golfSection.style.display = "none";
                window.dispatchEvent(new CustomEvent('golf-finished')); // Tell Alpine game is done
                curtain.style.transform = "translateY(-100%)";
            }, 1200);
        }

        initGolf(); drawGolf();
        window.addEventListener('resize', initGolf);

        // --- ALPINE ROMANTIC APP ---
        function romanticApp() {
            return {
                page: 'intro',
                gameEnded: false,
                hearts: 0,
                currentIdx: 0,
                questions: [
                    { text: "What is my favourite nickname for you?", options: ["Darla", "Sophie", "Aunty Soph"], correct: 0 },
                    { text: "What is Taylors favourite food in the world?", options: ["Mince wraps", "Pot noodle", "Phia's risotto"], correct: 2 },
                    { text: "When did we become Boyfriend and Girlfriend?", options: ["July 2024", "August 2024", "March 2024"], correct: 1 },
                    { text: "What is my favourite thing about Phi?", options: ["Pretty smile", "Funniest person ever", "Everything because she is the best girl in the world"], correct: 2 },
                    { text: "Which of the following should we do tonight?", options: ["Ignore each other", "Cosy movie and cuddle", "FaceTime"], correct: 1 }
                ],
                notes: [
                    { title: "I love you because...", content: "Being around you makes me feel confident in ways I used to fake.", cost: 1, unlocked: false },
                    { title: "I love you because...", content: "You're impossibly optimistic, yet you smash every goal you set.", cost: 2, unlocked: false },
                    { title: "I love you because...", content: "You make all the pressure disappear and calm me so completely that I forget productivity even matters.", cost: 2, unlocked: false }
                ],
                init() {
                    window.addEventListener('golf-finished', () => { this.gameEnded = true; });
                },
                answer(idx) {
                    if (idx === this.questions[this.currentIdx].correct) this.hearts++;
                    if (this.currentIdx < this.questions.length - 1) this.currentIdx++;
                    else this.page = 'vault';
                },
                unlock(idx) {
                    if (this.hearts >= this.notes[idx].cost) {
                        this.hearts -= this.notes[idx].cost;
                        this.notes[idx].unlocked = true;
                    }
                }
            }
        }
    </script>
</body>
</html>